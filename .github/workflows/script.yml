name: Main Branch

# on:
#   push:
#     branches:
#       - xxx
#   schedule: 
#     - cron: "0 3 * * 1" 
on:
    workflow_dispatch:
    schedule: 
      - cron: "0 3 * * 1"
    # push:
    #     branches:
    #     - xxx

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: 16

      - name: Install dependencies
        run: npm install request-promise uuid crypto-js crypto fs date-fns

      - name: Run JavaScript script
        run: node index.js

      - name: Commit and Push Changes
        run: |
            git config --local user.email "haoyu3@163.com"
            git config --local user.name "haoyu3_git"
            git pull
            git add .
            git commit -m "Auto-generated files"
            git push
